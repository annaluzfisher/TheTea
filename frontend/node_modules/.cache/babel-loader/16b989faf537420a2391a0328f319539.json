{"ast":null,"code":"import _regeneratorRuntime from\"/Users/postgres/Desktop/Tea/teafrontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/postgres/Desktop/Tea/teafrontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";export var restoreCSRF=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var result,token,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return csrfFetch(\"/api/session\");case 2:result=_context.sent;token=result.headers.get(\"X-CSRF-Token\");if(token)sessionStorage.setItem(\"X-CSRF-Token\",token);_context.next=7;return result.json();case 7:data=_context.sent;restoreCurrentUser(data);return _context.abrupt(\"return\",data);case 10:case\"end\":return _context.stop();}}},_callee);}));return function restoreCSRF(){return _ref.apply(this,arguments);};}();export var restoreCurrentUser=function restoreCurrentUser(response){if(response.user){sessionStorage.setItem(\"currentUser\",JSON.stringify(response.user.id));}else{sessionStorage.setItem(\"currentUser\",null);}};var csrfFetch=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(url){var options,res,_args2=arguments;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:options=_args2.length>1&&_args2[1]!==undefined?_args2[1]:{};options.method||(options.method=\"GET\");options.headers||(options.headers={});if(options.method.toUpperCase()!==\"GET\"){options.headers[\"Content-Type\"]=\"application/json\";options.headers[\"Accept\"]=\"application/json\";options.headers[\"X-CSRF-Token\"]=sessionStorage.getItem(\"X-CSRF-Token\");}_context2.next=6;return fetch(url,options);case 6:res=_context2.sent;if(!(res.status>=400)){_context2.next=9;break;}throw res;case 9:return _context2.abrupt(\"return\",res);case 10:case\"end\":return _context2.stop();}}},_callee2);}));return function csrfFetch(_x){return _ref2.apply(this,arguments);};}();export default csrfFetch;","map":{"version":3,"names":["restoreCSRF","csrfFetch","result","token","headers","get","sessionStorage","setItem","json","data","restoreCurrentUser","response","user","JSON","stringify","id","url","options","method","toUpperCase","getItem","fetch","res","status"],"sources":["/Users/postgres/Desktop/Tea/teafrontend/src/store/csrf.js"],"sourcesContent":["export const restoreCSRF = async () => {\n  const result = await csrfFetch(\"/api/session\");\n    const token = result.headers.get(\"X-CSRF-Token\");\n    if (token) sessionStorage.setItem(\"X-CSRF-Token\", token);\n  let data = await result.json();\n  restoreCurrentUser(data);\n  return data;\n};\n\nexport const restoreCurrentUser = (response) => {\n  if (response.user) {\n    sessionStorage.setItem(\"currentUser\", JSON.stringify(response.user.id));\n  } else {\n    sessionStorage.setItem(\"currentUser\", null);\n  }\n};\n\n\n\n\n\n\n\nconst csrfFetch = async (url, options = {}) => {\n  options.method ||= \"GET\";\n  options.headers ||= {};\n\n  if (options.method.toUpperCase() !== \"GET\") {\n    options.headers[\"Content-Type\"] = \"application/json\";\n    options.headers[\"Accept\"] = \"application/json\";\n    options.headers[\"X-CSRF-Token\"] = sessionStorage.getItem(\"X-CSRF-Token\");\n  }\n  const res = await fetch(url, options);\n  if (res.status >= 400) throw res;\n  return res;\n};\n\nexport default csrfFetch;\n"],"mappings":"0QAAA,MAAO,IAAMA,YAAW,4FAAG,iLACJC,UAAS,CAAC,cAAD,CADL,QACnBC,MADmB,eAEjBC,KAFiB,CAETD,MAAM,CAACE,OAAP,CAAeC,GAAf,CAAmB,cAAnB,CAFS,CAGvB,GAAIF,KAAJ,CAAWG,cAAc,CAACC,OAAf,CAAuB,cAAvB,CAAuCJ,KAAvC,EAHY,sBAIRD,OAAM,CAACM,IAAP,EAJQ,QAIrBC,IAJqB,eAKzBC,kBAAkB,CAACD,IAAD,CAAlB,CALyB,gCAMlBA,IANkB,yDAAH,kBAAXT,YAAW,0CAAjB,CASP,MAAO,IAAMU,mBAAkB,CAAG,QAArBA,mBAAqB,CAACC,QAAD,CAAc,CAC9C,GAAIA,QAAQ,CAACC,IAAb,CAAmB,CACjBN,cAAc,CAACC,OAAf,CAAuB,aAAvB,CAAsCM,IAAI,CAACC,SAAL,CAAeH,QAAQ,CAACC,IAAT,CAAcG,EAA7B,CAAtC,EACD,CAFD,IAEO,CACLT,cAAc,CAACC,OAAf,CAAuB,aAAvB,CAAsC,IAAtC,EACD,CACF,CANM,CAcP,GAAMN,UAAS,6FAAG,kBAAOe,GAAP,yJAAYC,OAAZ,kDAAsB,EAAtB,CAChBA,OAAO,CAACC,MAAR,GAAAD,OAAO,CAACC,MAAR,CAAmB,KAAnB,EACAD,OAAO,CAACb,OAAR,GAAAa,OAAO,CAACb,OAAR,CAAoB,EAApB,EAEA,GAAIa,OAAO,CAACC,MAAR,CAAeC,WAAf,KAAiC,KAArC,CAA4C,CAC1CF,OAAO,CAACb,OAAR,CAAgB,cAAhB,EAAkC,kBAAlC,CACAa,OAAO,CAACb,OAAR,CAAgB,QAAhB,EAA4B,kBAA5B,CACAa,OAAO,CAACb,OAAR,CAAgB,cAAhB,EAAkCE,cAAc,CAACc,OAAf,CAAuB,cAAvB,CAAlC,CACD,CARe,uBASEC,MAAK,CAACL,GAAD,CAAMC,OAAN,CATP,QASVK,GATU,qBAUZA,GAAG,CAACC,MAAJ,EAAc,GAVF,gCAUaD,IAVb,yCAWTA,GAXS,2DAAH,kBAATrB,UAAS,6CAAf,CAcA,cAAeA,UAAf"},"metadata":{},"sourceType":"module"}