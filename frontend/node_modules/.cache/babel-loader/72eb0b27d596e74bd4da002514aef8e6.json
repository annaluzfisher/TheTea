{"ast":null,"code":"import _objectSpread from\"/Users/postgres/Desktop/Tea/teafrontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"/Users/postgres/Desktop/Tea/teafrontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/postgres/Desktop/Tea/teafrontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import csrfFetch from\"./csrf\";var RECEIVE_CURRENT_USER='users/RECEIVE_CURRENT_USER';var REMOVE_CURRENT_USER='users/REMOVE_CURRENT_USER';export var receiveCurrentUser=function receiveCurrentUser(user){return{type:RECEIVE_CURRENT_USER,user:user};};export var removeCurrentUser=function removeCurrentUser(user){return{type:REMOVE_CURRENT_USER,user:user};};export var loginUser=function loginUser(user){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(dispatch){var res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return csrfFetch('/api/session',{method:'POST',body:JSON.stringify(user)}).then(function(res){return res.json();}).then(function(res){return dispatch(receiveCurrentUser(res));}).catch(function(err){return console.log(err);});case 2:res=_context.sent;case 3:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};var currentUser=sessionStorage.getItem('currentUser');var initialState;if(currentUser){initialState={user:JSON.parse(currentUser)};}else{initialState={user:null};}export var sessionReducer=function sessionReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;Object.freeze(state);var newState=_objectSpread({},state);switch(action.type){case RECEIVE_CURRENT_USER:return _objectSpread(_objectSpread({},newState),action.user);case REMOVE_CURRENT_USER:newState={user:null};return newState;default:return newState;}};// session reducer is only one slice of state","map":{"version":3,"names":["csrfFetch","RECEIVE_CURRENT_USER","REMOVE_CURRENT_USER","receiveCurrentUser","user","type","removeCurrentUser","loginUser","dispatch","method","body","JSON","stringify","then","res","json","catch","err","console","log","currentUser","sessionStorage","getItem","initialState","parse","sessionReducer","state","action","Object","freeze","newState"],"sources":["/Users/postgres/Desktop/Tea/teafrontend/src/store/sessionReducer.js"],"sourcesContent":["import csrfFetch from \"./csrf\";\n\nconst RECEIVE_CURRENT_USER = 'users/RECEIVE_CURRENT_USER'\nconst REMOVE_CURRENT_USER = 'users/REMOVE_CURRENT_USER'\n\nexport const receiveCurrentUser = user =>({\n  type: RECEIVE_CURRENT_USER,\n  user\n})\n\nexport const removeCurrentUser = (user) => ({\n  type: REMOVE_CURRENT_USER,\n  user\n});\n\n\nexport const loginUser =  (user) => async (dispatch) => {\n   let res = await csrfFetch('/api/session',{\n    method: 'POST',\n    body: JSON.stringify(user)\n   }).then((res) => res.json()).then((res) => dispatch(receiveCurrentUser(res)))\n   .catch((err) => console.log(err));\n}\nconst currentUser = sessionStorage.getItem('currentUser')\nlet initialState;\nif (currentUser){\n  initialState = {user: JSON.parse(currentUser)}\n} else{\n  initialState = { user: null}\n}\n\nexport const sessionReducer = (state = initialState, action) => {\n  Object.freeze(state);\n  let newState = { ...state }\n  switch (action.type) {\n    case RECEIVE_CURRENT_USER:\n    return {...newState,...action.user}\n    case REMOVE_CURRENT_USER:\n    newState = {user: null}\n    return newState\n    default:\n      return newState;\n  }\n}\n\n// session reducer is only one slice of state "],"mappings":"sYAAA,MAAOA,UAAP,KAAsB,QAAtB,CAEA,GAAMC,qBAAoB,CAAG,4BAA7B,CACA,GAAMC,oBAAmB,CAAG,2BAA5B,CAEA,MAAO,IAAMC,mBAAkB,CAAG,QAArBA,mBAAqB,CAAAC,IAAI,QAAI,CACxCC,IAAI,CAAEJ,oBADkC,CAExCG,IAAI,CAAJA,IAFwC,CAAJ,EAA/B,CAKP,MAAO,IAAME,kBAAiB,CAAG,QAApBA,kBAAoB,CAACF,IAAD,QAAW,CAC1CC,IAAI,CAAEH,mBADoC,CAE1CE,IAAI,CAAJA,IAF0C,CAAX,EAA1B,CAMP,MAAO,IAAMG,UAAS,CAAI,QAAbA,UAAa,CAACH,IAAD,mGAAU,iBAAOI,QAAP,kJACjBR,UAAS,CAAC,cAAD,CAAgB,CACxCS,MAAM,CAAE,MADgC,CAExCC,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAeR,IAAf,CAFkC,CAAhB,CAAT,CAGbS,IAHa,CAGR,SAACC,GAAD,QAASA,IAAG,CAACC,IAAJ,EAAT,EAHQ,EAGaF,IAHb,CAGkB,SAACC,GAAD,QAASN,SAAQ,CAACL,kBAAkB,CAACW,GAAD,CAAnB,CAAjB,EAHlB,EAIfE,KAJe,CAIT,SAACC,GAAD,QAASC,QAAO,CAACC,GAAR,CAAYF,GAAZ,CAAT,EAJS,CADiB,QAC7BH,GAD6B,qEAAV,gEAAnB,CAOP,GAAMM,YAAW,CAAGC,cAAc,CAACC,OAAf,CAAuB,aAAvB,CAApB,CACA,GAAIC,aAAJ,CACA,GAAIH,WAAJ,CAAgB,CACdG,YAAY,CAAG,CAACnB,IAAI,CAAEO,IAAI,CAACa,KAAL,CAAWJ,WAAX,CAAP,CAAf,CACD,CAFD,IAEM,CACJG,YAAY,CAAG,CAAEnB,IAAI,CAAE,IAAR,CAAf,CACD,CAED,MAAO,IAAMqB,eAAc,CAAG,QAAjBA,eAAiB,EAAkC,IAAjCC,MAAiC,2DAAzBH,YAAyB,IAAXI,OAAW,2CAC9DC,MAAM,CAACC,MAAP,CAAcH,KAAd,EACA,GAAII,SAAQ,kBAAQJ,KAAR,CAAZ,CACA,OAAQC,MAAM,CAACtB,IAAf,EACE,IAAKJ,qBAAL,CACA,sCAAW6B,QAAX,EAAuBH,MAAM,CAACvB,IAA9B,EACA,IAAKF,oBAAL,CACA4B,QAAQ,CAAG,CAAC1B,IAAI,CAAE,IAAP,CAAX,CACA,MAAO0B,SAAP,CACA,QACE,MAAOA,SAAP,CAPJ,CASD,CAZM,CAcP"},"metadata":{},"sourceType":"module"}