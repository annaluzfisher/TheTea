{"ast":null,"code":"import csrfFetch from \"./csrf\";\nconst RECEIVE_CURRENT_USER = 'users/RECEIVE_CURRENT_USER';\nconst REMOVE_CURRENT_USER = 'users/REMOVE_CURRENT_USER';\nexport const receiveCurrentUser = user => ({\n  type: RECEIVE_CURRENT_USER,\n  user\n});\nexport const removeCurrentUser = userId => ({\n  type: REMOVE_CURRENT_USER,\n  userId\n});\nexport const loginUser = user => async dispatch => {\n  console.log(\"in login, pre-fetch\", user);\n  let res = await csrfFetch('/api/session', {\n    method: 'POST',\n    body: JSON.stringify(user)\n  }).then(res => res.json()).catch();\n  console.log(\"data\", res);\n  let data = await res.json();\n  console.log('data', data);\n  dispatch(receiveCurrentUser(data));\n};\nlet currentUser = sessionStorage.getItem('currentUser');\nlet initialState;\n\nif (currentUser) {\n  initialState = {\n    user: JSON.parse(currentUser)\n  };\n} else {\n  initialState = {\n    user: null\n  };\n}\n\nexport const sessionReducer = function () {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialState;\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n  Object.freeze(state);\n  const newState = { ...state\n  };\n\n  switch (action.type) {\n    case RECEIVE_CURRENT_USER:\n      return { ...action.user\n      };\n\n    case REMOVE_CURRENT_USER:\n      delete newState[action.userId];\n      return newState;\n\n    default:\n      return newState;\n  }\n};","map":{"version":3,"names":["csrfFetch","RECEIVE_CURRENT_USER","REMOVE_CURRENT_USER","receiveCurrentUser","user","type","removeCurrentUser","userId","loginUser","dispatch","console","log","res","method","body","JSON","stringify","then","json","catch","data","currentUser","sessionStorage","getItem","initialState","parse","sessionReducer","state","action","Object","freeze","newState"],"sources":["/Users/postgres/Desktop/Tea/teafrontend/src/store/sessionReducer.js"],"sourcesContent":["import csrfFetch from \"./csrf\";\n\nconst RECEIVE_CURRENT_USER = 'users/RECEIVE_CURRENT_USER'\nconst REMOVE_CURRENT_USER = 'users/REMOVE_CURRENT_USER'\n\nexport const receiveCurrentUser = user =>({\n  type: RECEIVE_CURRENT_USER,\n  user\n})\n\nexport const removeCurrentUser = (userId) => ({\n  type: REMOVE_CURRENT_USER,\n  userId\n});\n\n\nexport const loginUser =  (user) => async (dispatch) => {\n    console.log(\"in login, pre-fetch\", user);\n   let res = await csrfFetch('/api/session',{\n    method: 'POST',\n    body: JSON.stringify(user)\n   }).then((res) => res.json())\n   .catch()\n      console.log(\"data\", res);\n   let data = await res.json();\n   console.log('data', data)\n   dispatch(receiveCurrentUser(data))\n}\n\nlet currentUser = sessionStorage.getItem('currentUser');\nlet initialState;\nif (currentUser) {\n  initialState = {user :  JSON.parse(currentUser)}\n} else {\n  initialState = {user : null}\n}\n\nexport const sessionReducer = (state = initialState , action) => {\n  Object.freeze(state);\n  const newState = { ...state }\n  switch (action.type) {\n    case RECEIVE_CURRENT_USER:\n    return {...action.user}\n    case REMOVE_CURRENT_USER:\n    delete newState[action.userId]\n    return newState\n    default:\n      return newState;\n  }\n}"],"mappings":"AAAA,OAAOA,SAAP,MAAsB,QAAtB;AAEA,MAAMC,oBAAoB,GAAG,4BAA7B;AACA,MAAMC,mBAAmB,GAAG,2BAA5B;AAEA,OAAO,MAAMC,kBAAkB,GAAGC,IAAI,KAAI;EACxCC,IAAI,EAAEJ,oBADkC;EAExCG;AAFwC,CAAJ,CAA/B;AAKP,OAAO,MAAME,iBAAiB,GAAIC,MAAD,KAAa;EAC5CF,IAAI,EAAEH,mBADsC;EAE5CK;AAF4C,CAAb,CAA1B;AAMP,OAAO,MAAMC,SAAS,GAAKJ,IAAD,IAAU,MAAOK,QAAP,IAAoB;EACpDC,OAAO,CAACC,GAAR,CAAY,qBAAZ,EAAmCP,IAAnC;EACD,IAAIQ,GAAG,GAAG,MAAMZ,SAAS,CAAC,cAAD,EAAgB;IACxCa,MAAM,EAAE,MADgC;IAExCC,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAeZ,IAAf;EAFkC,CAAhB,CAAT,CAGba,IAHa,CAGPL,GAAD,IAASA,GAAG,CAACM,IAAJ,EAHD,EAIfC,KAJe,EAAhB;EAKGT,OAAO,CAACC,GAAR,CAAY,MAAZ,EAAoBC,GAApB;EACH,IAAIQ,IAAI,GAAG,MAAMR,GAAG,CAACM,IAAJ,EAAjB;EACAR,OAAO,CAACC,GAAR,CAAY,MAAZ,EAAoBS,IAApB;EACAX,QAAQ,CAACN,kBAAkB,CAACiB,IAAD,CAAnB,CAAR;AACF,CAXM;AAaP,IAAIC,WAAW,GAAGC,cAAc,CAACC,OAAf,CAAuB,aAAvB,CAAlB;AACA,IAAIC,YAAJ;;AACA,IAAIH,WAAJ,EAAiB;EACfG,YAAY,GAAG;IAACpB,IAAI,EAAIW,IAAI,CAACU,KAAL,CAAWJ,WAAX;EAAT,CAAf;AACD,CAFD,MAEO;EACLG,YAAY,GAAG;IAACpB,IAAI,EAAG;EAAR,CAAf;AACD;;AAED,OAAO,MAAMsB,cAAc,GAAG,YAAmC;EAAA,IAAlCC,KAAkC,uEAA1BH,YAA0B;EAAA,IAAXI,MAAW;EAC/DC,MAAM,CAACC,MAAP,CAAcH,KAAd;EACA,MAAMI,QAAQ,GAAG,EAAE,GAAGJ;EAAL,CAAjB;;EACA,QAAQC,MAAM,CAACvB,IAAf;IACE,KAAKJ,oBAAL;MACA,OAAO,EAAC,GAAG2B,MAAM,CAACxB;MAAX,CAAP;;IACA,KAAKF,mBAAL;MACA,OAAO6B,QAAQ,CAACH,MAAM,CAACrB,MAAR,CAAf;MACA,OAAOwB,QAAP;;IACA;MACE,OAAOA,QAAP;EAPJ;AASD,CAZM"},"metadata":{},"sourceType":"module"}